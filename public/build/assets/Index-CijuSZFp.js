import{M as _}from"./MainLayout-DcgTcTgG.js";import{o as s,c as h,w as l,a as e,f as a,r as d,F as u,t as c,j as f,d as p,u as m,i as v}from"./app-DHy2bZu3.js";import"./Dropdown-Bec3s7gg.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";const y={class:"flex flex-col gap-y-5"},g={class:"order__title flex justify-between py-1"},x={class:"font-bold"},w={key:0,class:"bg-violet-500 bg-opacity-25 px-3"},k={key:0},b={key:1},C={key:2},E={key:3},I={key:4},D={class:"flex justify-between"},N={class:"grid grid-cols-1 gap-5"},S={class:"grid grid-cols-2"},j={class:"flex max-h-24 max-w-[120px]"},A=["src"],B={class:"content-center font-bold"},L={class:"font-bold align-middle content-start"},q={data(){return{requestCount:0}},methods:{checkStatus(){if(this.requestCount>=5){clearInterval(this.statusInterval);return}axios.get("/payment/status").then(o=>{this.updateOrderStatuses(o.data),this.requestCount++}).catch(o=>{console.log("status error",o)})},updateOrderStatuses(o){o.forEach(n=>{const r=this.orders.find(t=>t.id===n.id);r&&r.transaction.status!==n.transaction.status&&(r.transaction.status=n.transaction.status)})}},mounted(){this.statusInterval=setInterval(()=>{this.checkStatus()},1e4)},beforeDestroy(){clearInterval(this.statusInterval)}},R=Object.assign(q,{__name:"Index",props:{orders:Array},setup(o){return(n,r)=>(s(),h(_,{class:""},{default:l(()=>[e("div",y,[(s(!0),a(u,null,d(o.orders,t=>(s(),a("div",{class:"sm:px-5 border-2 py-3",key:t.id},[e("div",g,[e("div",x,"Заказ от "+c(t.created_at),1),t.transaction?(s(),a("div",w,[t.transaction.status==="CANCELLED"?(s(),a("span",k,"Отменен")):t.transaction.status==="CREATED"?(s(),a("span",b,"В ожидании")):t.transaction.status==="PAID"?(s(),a("span",C,"Завершен")):t.transaction.status==="REFUNDED"?(s(),a("span",E,"Возврат")):(s(),a("span",I,"Неизвестный статус"))])):f("",!0)]),e("div",D,[e("div",N,[(s(!0),a(u,null,d(t.order_items,i=>(s(),a("div",S,[e("div",j,[p(m(v),{href:n.route("flowers.show",i.flowers.id)},{default:l(()=>[e("img",{src:i.flowers.image_path,alt:"flower",class:"rounded-lg max-h-24 max-w-[120px]"},null,8,A)]),_:2},1032,["href"])]),e("div",B,[e("div",null,c(i.flowers.name),1),e("div",null,c(i.flowers.price)+" ₽ ",1)])]))),256))]),e("div",L,c(t.transaction.price)+" ₽ ",1)])]))),128))])]),_:1}))}});export{R as default};
